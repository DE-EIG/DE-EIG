#include "stdafx.h"

double DEEIG_z[30];
double DEEIG_tmp[30];
const double DEEIG_xopt[] = {6.56660495795180,6.82732017808332,1.91060710529340,42.7128063665524,-48.6002090486050,50.5387217744222,76.7758367379088,-69.0201834933408,34.1092876697852,28.6890317179744,44.7254338354134,49.7450400133610,63.7094789908098,-80.4182954263364,-99.2892185583770,-53.8380769037364,-97.5489733367300,-29.2916577881736,-62.9437045674004,58.5536807458426,22.4344051306232,79.8858250913068,-36.9264441113180,-18.6689114928201,96.0517207355284,8.41303597976036,-51.5410776114140,-49.5516635768722,13.0311572813592,-73.3326240171592};
const double DEEIG_R[30][30] = {
	{0.0662846489770030,0.116644179508409,0.0808602616949929,0.0228899180795043,-0.0461481649538253,0.104500640233303,0.331021183387912,0.194429368032480,-0.0592437114302285,-0.144868308367164,0.0132501024971428,-0.157423304217347,0.0193354189068079,0.0228552473098438,0.0117493368075911,-0.0427820159402679,0.00877091382182611,0.0833492087682821,0.0577783455103554,-0.0823786365372447,-0.0113712481573524,0.103563884010907,0.0956518723194721,-0.193941133932376,-0.0612538704823772,-0.0872763698788038,-0.0467963279206225,0.195979655255773,-0.0352897181991837,0.126716328703400},
	{-0.0640656583652029,-0.00463423962514608,0.0241128828926346,0.0631544399490938,0.135004867308664,0.150096168735993,0.0235264537731207,0.146221569494691,0.0799734431168485,0.00218561448536312,-0.186226973081887,-0.118391183095641,0.136935674604731,-0.0766110447495322,-0.0610020391095566,0.281510855408987,0.105861505014885,-0.186896475707767,-0.0438795437445199,0.0207260298127436,-0.0240818971551688,-0.127156673598927,-0.0789255878266419,-0.100018498350745,0.0407834277900219,0.0199450817307129,0.0450958399944317,-0.0422660877044103,-0.00904742615384898,-0.0712481665089477},
	{-0.0168517360411373,0.0310350294870649,0.0660418795529102,0.0612226934080073,-0.0379890520213902,0.0455537894630456,0.0305086129825960,0.151586985277716,0.0427489531086425,-0.0217552035939392,0.00254191935099616,0.0728482231369492,-0.0122623352787393,0.184711086887571,-0.0725977725850161,-0.0626459720803592,0.137902810334577,0.0140103838030431,-0.157288114053659,0.0963453210061947,0.0172195374039999,-0.0345848478445549,-0.0575988466563229,-0.0100951397568052,0.00360420077535309,-0.0456515168090532,0.104003688660185,-0.134474929730951,0.0820880504959935,-0.0770149040454849},
	{-0.0614627047030749,-0.0510403662357927,0.00827127197463437,0.0997578470530479,-0.0396208918985934,0.0250499457502744,-0.0972237795913108,0.0247114925929694,-0.0991493608758403,0.116799536634855,0.151028649029350,0.159209154968095,0.0304435364699529,-0.0173790586109609,0.0516406104661154,0.102926797186229,-0.0448679244613911,-0.0133861584603967,0.0472736547644949,0.161062759328018,-0.208661492088696,0.0172699713292147,0.0671935830534612,-0.0272480502207650,-0.0796940424110273,-0.00175668352700396,0.204013865711430,-0.0914573758987413,0.00605758017848720,0.0577250844529872},
	{0.0100307148218770,0.0502552257462941,-0.113034593239234,-0.152730477869726,0.0133261544792919,-0.167587538419666,-0.108619779504601,0.0164310983807475,-0.219166287475752,0.144899083489395,-0.0518550240296457,0.0483061710229846,0.0701413346995248,-0.0747589168078739,-0.121209986368474,-0.0915433865205025,0.0907555567257564,0.0948490393855618,0.0726887422255761,-0.0417334795836129,0.0906263883786180,0.0479662816672542,-0.0273438213206739,-0.0314117773283049,0.121463703235775,-0.135795437520629,-0.143589763392781,0.183945006427958,0.115245050845814,-0.0581924533601891},
	{0.211077107736587,0.0450323831491580,0.0168778817742380,-0.0628785395511873,0.0584520661809662,0.0301564594259261,0.159261082542451,0.0830991293931476,-0.129803426208318,0.0191570371592692,0.0507174873460156,-0.0673736489723989,-0.0114053823689415,-0.0141978450993887,0.0235926374999678,-0.163993645558507,0.160308385606146,0.0167193916025228,-0.0511525946493325,-0.105135125973066,-0.176100489331638,-0.0626214245589333,0.207357342741957,-0.195679097523795,0.217986073612012,0.130452796186946,-0.0755850151128615,-0.00819493142895537,-0.0585473279522471,-0.153213430969907},
	{0.159804167887191,-0.0792267265428576,0.224365147827232,-0.135731411999992,-0.131536169302365,-0.149156138366665,0.00852190932518387,0.00582720472026077,0.0824779765105460,-0.111106436968565,0.0489238794214752,0.0253118431018866,0.0398345192202809,-0.178084141241622,-0.0496060700760064,0.117558692731359,-0.0778007458746504,0.0895823327595513,-0.0281410030899819,-0.0399081727565311,-0.132697816193875,0.0273293124819803,-0.00213758752466643,0.200077397688916,0.0414928811702410,0.141600700981202,0.0297073882106466,0.0370355117130822,0.00966081521763242,0.175601811199271},
	{0.00693192578364542,0.0101257236523559,-0.115995833462194,-0.160510015816439,-0.0668297459309083,-0.0146367052336719,0.0288097964314767,0.0411685261745609,0.0759702497283488,0.192223959808363,-0.0189549169561219,0.0196245400151962,0.0421182209090825,0.199780842238373,0.152385904048749,-0.0814110585583308,-0.0285985111584295,-0.0439590575245546,0.0764276219703948,0.0663647115972078,-0.0135850033403254,-0.0793968309106301,0.0336832272218639,-0.0579527464139599,-0.0598842025522407,0.151680402760838,0.0990108313410004,-0.00598916171469565,0.0815262696581890,-0.0275677898875815},
	{0.0412670400143786,-0.0596884038937391,0.0620513532950551,-0.0593393722252585,-0.0788932919934765,-0.00135908185450141,0.133491634742034,0.00747586373258784,0.161794971000345,-0.0679088020013813,0.0356015086087536,0.101433100378030,0.209679899933870,0.0185032782513733,0.0293628618275938,0.0833074331761748,0.0472857010191875,0.193351047160839,0.114533266412344,-0.0956238931315786,0.0206579490129253,-0.152651802935929,-0.152231338847340,0.0229490258455415,-0.111334812444883,0.113683427139620,0.0569350962823128,-0.0112755885442727,-0.0612217755025161,-0.0160437777282615},
	{0.0931879070264766,-0.0660852051926989,0.0708926220630113,0.147280152769252,-0.0911817845942051,-0.0219994247924362,-0.184791697132986,-0.0506602305613220,-0.0510898502465611,-0.0679993942341129,0.0752214260627576,0.195471453538809,-0.0860541244630122,0.0920279721651691,-0.0671997851565722,0.0924741953227212,0.0911395624812640,0.198601470515739,-0.130043956354148,0.0423164978275091,-0.0435608868063692,0.0125005221504943,0.0361408840200213,-0.306333387262983,0.0133306697056621,-0.0571896647039667,-0.0144147086963508,-0.0719564254409169,-0.0719609189514028,0.176674551129838},
	{0.0851142497324422,0.0584579443116226,-0.193290714655018,0.129110426704108,0.0274610399853801,-0.233091900918206,-0.120179950919137,0.0248890043745789,-0.111084375334414,0.0149507765889409,0.0708799843665564,0.131106213043176,0.0932780331497447,0.186252135010022,-0.114037992345617,-0.0164218997788043,-0.124185904532853,-0.142540855761627,0.220182279584632,-0.115594737682560,-0.106051533546353,0.108691873205028,-0.0310878193543170,-0.136533244651435,-0.0252920327100385,0.00469721659201139,0.0238814781031005,0.0571448659197479,0.215323915597095,0.164409163771582},
	{-0.0296905746511488,-0.193691780784082,0.101111691427097,0.0106682241473383,-0.142261004015283,0.0312318463028997,0.0655964713180215,-0.0294939983916199,-0.0412574628311163,0.0445682065629757,-0.0640681812911223,0.0166216445249131,0.114647943153681,-0.0334836165224823,0.00413431699591910,-0.0334264607902011,0.0737304902714957,0.0362468715939403,-0.119106572019506,-0.105983816685779,-0.0269152833461338,0.0197195682061842,0.0578777889328181,0.176441904298676,0.0579796397355623,0.198789712728732,0.0414377594448053,-0.0573384838960147,-0.0221439200750743,-0.135246291558612},
	{-0.0479897231926836,0.00818785161647174,0.0248119608971466,0.100047947656707,-0.00133628236337745,0.00751984842059693,0.0384814008339574,-0.0738121522419870,-0.0820669434428268,-0.0453341967373936,0.0135417556244252,-0.0633501873229230,-0.115156482257324,0.0438026494827047,0.0657108230400673,-0.0824395615205478,0.112722660997208,-0.00499809239817107,-0.0371403998100198,-0.157688585511755,0.195261573064884,0.157259697940263,-0.0764866372175982,0.103974237055982,-0.183507332724244,0.290751515986862,-0.120872607991276,-0.0541735705926915,0.110480638934450,0.00777822500041136},
	{-0.00286745874409838,-0.0656600674507156,0.133063720614173,-0.0292980105073063,0.132835964783098,0.0571155668533692,-0.0670583265564960,-0.336305251111345,-0.145322602195735,-0.00954321131071442,-0.0920126176888210,0.127485523798893,0.0954660479599144,-0.193373451711087,0.0471878806491161,0.225537278787897,-0.0414109921548042,-0.0519095678301556,-0.172801490256462,0.129732471530010,0.0523205360727192,-0.0290627148916318,-0.0485116081092036,0.00743083034092919,-0.0303885234213723,0.0217365824568559,-0.0328199401140089,0.0690226110439834,-0.0676362975421569,0.114089209518179},
	{-0.0420504683573700,-0.0829804452871222,-0.0906873452073130,-0.0802184146372117,0.253716690098480,-0.0619494494471250,0.0913251515171402,-0.0782154857264119,-0.00870764372664570,0.0717712539771716,0.0281961897180455,-0.182249848333885,-0.171684914632650,-0.0385341480681419,-0.104813957695657,0.0295421993990609,0.0762730597266028,-0.131037930368249,-0.0362371289687124,-0.0690949231898909,-0.0209525846882172,-0.00700566761919223,0.00147191962402302,-0.0128317215247311,-0.0232672363945268,0.179448404320630,-0.0377388375353058,0.0666872402119397,0.0873865580624151,0.0154179552873772},
	{0.0831678460078488,0.00258354229703387,-0.0754561296930101,0.0606552454619540,-0.0981430097434488,-0.0455398863985306,0.226137112957897,0.119417704948596,-0.0964004355263346,0.0772043048123293,0.0671849172772586,0.184286829445426,-0.0820933208593393,-0.0731432592923001,0.103311425779815,0.206095286405010,0.00455240520129866,0.0809190823270771,-0.0848018880302618,-0.0735550499832190,0.000290817718292140,0.0210612447464385,-0.0427536825332526,0.00976088099322604,0.00139235210553589,0.0984831151218833,-0.0136428504100186,-0.0709023609550107,0.156463330950836,0.0251462424939164},
	{-0.0603695519745272,0.0743497313002657,0.0232375639575884,0.00966443294502952,0.0647214846114023,-0.134998264404488,0.00602086281271017,-0.00145149152165450,0.00600547004438052,0.110855296388945,0.106595295024499,0.120566012454016,0.0241091456186757,-0.188444884989332,0.00936059612786299,0.0470378674636561,-0.0989808620204389,0.0211362202868031,-0.105878870628208,0.166719889546694,0.0500545232331808,-0.113542608771009,0.126186224446554,-0.0734149037967816,0.0522748583207884,0.0892026857445494,0.0109567735699799,-0.0969586308085351,0.00610772009613617,0.0641029001830489},
	{-0.0285822324596778,0.148692022958390,-0.271041211449846,0.171641815514756,0.0154484687049034,0.0148609837980258,-0.0369925929482297,-0.0152212943137442,0.0331389225191251,-0.161965480991956,-0.0351413823840703,0.168522902117105,-0.0731984603912043,0.146164499979161,0.0161231327110898,0.0372628414238868,0.00547757297765371,0.0480905384530779,-0.137365624426427,0.0250698468107529,-0.253209732677229,-0.0794912334839439,0.167627248443369,0.00486204948189278,0.0267802799936131,0.164731874548377,-0.176548402073284,-0.0231856817194701,0.118894146282746,0.0662773505260600},
	{0.0415178825404159,-0.0144658525943739,0.0800467673062833,-0.0675329194094651,0.0939353245482612,-0.114674607925846,-0.0112414939581569,-0.0356734500216696,0.151074119006630,0.0314393846537785,0.0403400964122396,0.0732943104972337,-0.146527274920851,0.0133098914265473,0.0270229279861599,-0.181051021088648,-0.0815319873551049,-0.0757028458081950,-0.0850175780321254,0.0523148261763432,-0.00161214930191017,-0.146548317460572,-0.0380770368195518,-0.122969053112584,0.0931080142113728,-0.0776185871473359,0.0258519858364903,-0.0887653612859317,-0.0747268084123689,-0.118121204533436},
	{0.00576282406986644,-0.0135775341704807,-0.141022371395223,0.0137927910337163,-0.109047853075002,-0.0972152662504561,-0.0217689729994134,-0.0491614479944802,0.0932596904098199,-0.207739111203892,-0.0125512669262010,-0.0484778571460717,-0.0712254221714105,-0.0621525441159867,0.118881386041581,0.0570892579637864,0.0622801188321952,-0.0884474955093343,0.163466777228742,-0.0167447432753251,0.00640775041058459,0.0558529253795332,-0.0842159536555297,-0.0545543374447889,0.0190576760952049,-0.0405639933148724,0.0851753918219203,-0.187983378083230,0.263063893731170,-0.214530851815342},
	{0.225508551474790,0.172003350284580,0.0414347027266903,-0.00673122153460711,-0.00804599758896339,-0.0280966238788890,0.00472257594316656,-0.129026897466429,-0.159764383420087,-0.197583361697693,-0.109556580043308,0.110377554281535,-0.153108738871916,-0.0680776365684473,0.0290531918472515,-0.00595670409987687,-0.0134599526925110,-0.120471497809352,-0.120261562638087,-0.0334380934274734,0.0983029362877849,-0.0945902695872787,-0.131404162528504,0.0258910395464809,0.00530709527523757,0.107056781605141,0.0153323160552595,0.0550165842176577,-0.0891926753413546,-0.0383912354358391},
	{0.0628883609106723,-0.196026533149163,0.0872422614075217,-0.0881873305400618,0.0462157832249589,0.234016787825400,-0.0253336973527335,0.0657768942959438,-0.0543404953582284,-0.170957944393085,-0.177805234231671,0.0784329770757821,0.126304126107029,0.121635944512277,-0.159581099703386,0.0517260739435748,-0.0532717013665465,0.0524619170519730,0.0238232175711115,-0.201852137337229,0.0423956752141660,0.0408944780573550,0.159179173489591,-0.148137005927802,0.105769020182152,0.0606102835941377,0.0231244828181874,0.0693980673900357,0.0387841690739245,-0.123023443595564},
	{0.00575839253302005,0.108820982725329,-0.153947746002126,0.166944493731305,0.0613097678353019,-0.0567790075692432,0.182040313489336,-0.162637916528922,0.0266746097696557,0.210163619604940,-0.304456295849355,-0.0146416512299988,0.113735088653000,0.0351670826600359,-0.0375874378911941,0.0424203335521294,0.0783993667560655,-0.0364996659970406,0.000753489941906502,-0.102532809137647,-0.0971759936331095,-0.0632244190623635,-0.113330940898158,-0.00612943721143323,-0.131048260505252,-0.0540636714217886,0.132304814835541,-0.0125781583796382,0.0615788071071149,0.106612054347435},
	{-0.0375936909432730,0.0112265536101096,0.0200919154708400,0.103974542544421,0.0994227172747928,0.00111436436883579,0.0271937450674046,0.0887436477722873,0.0189488693283068,-0.192319461394083,-0.0700221215001026,-0.0812524005808519,-0.0408703551164447,-0.0171519909730277,0.0120756108885992,0.0457448111692610,0.262470150366133,-0.140693351081314,-0.0717420389844067,0.0987772926478598,-0.0275461462647706,0.0131316655163478,-0.156229709802700,-0.163938312885346,-0.0182347609495868,0.00230392450010765,0.00507043346514613,0.0414966772384775,0.0329715520979591,-0.225246597196396},
	{0.163592427197958,-0.0664047607883866,0.163351756985641,-0.0530553283107633,0.113995836256863,-0.0296637791446860,-0.227624829130870,0.100509293211083,-0.0254685313195825,0.0939873919485334,0.0496763672708452,0.0702585648607677,0.117457692716054,-0.0508669116355898,0.104784199716660,0.0794814975536123,0.0894821975160878,-0.0861568460231933,0.116285404669244,-0.195882533908038,0.0441080356880579,0.0334424980070391,0.0155887246176858,-0.0193184469112438,0.0291103182507178,-0.0889880732303397,0.0135558054047578,-0.0756687159722670,0.0689069825900804,-0.147380370776048},
	{0.108292346170586,0.0618896645018979,0.0419463319813806,0.000745881050104857,-0.144830105526292,-0.0358847145713582,0.0348803436387160,0.0814030568504399,0.0593417578470797,-0.103488046072162,0.133491178838088,0.00325879038929661,-0.00621748365305384,0.0300907322631395,-0.0709356998437749,0.0248637583095728,0.0720291667304129,-0.108829063697877,0.0172701074679434,0.0118925861368191,9.15809076806100e-05,-0.121379172244701,-0.0424725927079887,0.137930314823024,-0.0894163253553870,-0.0506183268242049,0.0962001213133284,0.111065781278412,-0.110989054934045,0.000234290042574147},
	{-0.177181506928712,-0.119309036111923,-0.187357086978105,-0.0755269632541101,0.0832298475941686,-0.198820491039252,-0.0659388469190749,-0.00191077037992594,-0.100212427815067,-0.107583088422091,0.102293902442694,-0.103713044161081,0.0953783922112054,0.0375166893753904,0.0388027620211122,-0.00254139937592914,0.0770291239679812,0.0687914074539934,-0.160768032507701,0.0225291806905886,0.00992034242690966,-0.144899529913729,-0.0974957937436241,-0.0654016030707381,-0.0824138703017891,-0.0774632118204685,-0.114004811563756,-0.100858217462194,-0.111536899722920,0.0187254784488372},
	{0.000135959433871907,-0.00490015994161793,-0.0173839837577883,0.105732230631150,-0.0705996835533186,-0.0456522799745346,-0.101736495106858,-0.113834357464949,-0.0328189422380632,-0.0357422421570923,0.172156897472601,-0.114682737948974,0.0462759536072427,0.123951949025771,0.00202015391125012,-0.0523402868134844,0.0529755659212782,0.0445049548240200,-0.110108970118373,-0.0866990394209838,0.108965274375075,-0.0267679579055143,-0.105559859958414,-0.0632527609145552,0.0180426230665002,-0.139132021817410,-0.0290719543732819,-0.00138122459030714,0.0802497981552557,0.0151485403977731},
	{0.00376252241620722,0.152301815031154,-0.128250896654440,-0.0648462065846299,0.175595921587145,0.125623797369370,-0.0573710750876243,0.150147393012581,-0.0597435994782978,0.0923557638589286,-0.0684478835712419,-0.112847892430608,-0.000795301350968637,-0.131894657662180,0.0142055961772418,-0.00816605693693743,-0.0612172300973190,0.188578895408388,0.0324259196563330,0.109171801958402,0.109404338230328,-0.0785034478736086,0.0360195031774195,-0.0551643355838740,-0.0914998385949794,0.0325926103005310,0.0503659130644948,0.116986785496051,-0.0755592026120244,0.113821809825759},
	{0.0752497537051108,0.0573032868556700,0.0271144778462594,-0.0298234925188856,-0.0123259279466216,0.0452269725538288,-0.0331895929289695,-0.0418906100947188,0.0170203397017543,0.0498851566405179,-0.150899997703782,0.105370877292569,0.0382619794004243,-0.0478354393578865,0.0776009249713469,0.0143745509234154,-0.0703934074489954,0.0480903942604503,0.101817537105056,0.0201856914699678,0.0441905275199594,-0.138473883630511,0.130271965991717,-0.120634998985901,-0.0866892403296755,-0.00726259424237939,-0.148041762851077,-0.00354657046693909,0.104327043466859,-0.155720244989120}
};
double ellipsoidalrot(double x[])
{
	for (int i = 0; i < 30; ++i)
	{
		DEEIG_z[i] = x[i] - DEEIG_xopt[i];
	}
	for (int i = 0; i < 30; ++i)
	{
		DEEIG_tmp[i] = 0;
		for (int j = 0; j < 30; ++j)
		{
			DEEIG_tmp[i] += DEEIG_R[i][j] * DEEIG_z[j];
		}
	}
	double f = 0;
	for (int i = 0; i < 30; ++i)
	{
		f += pow(10.0, 6.0 / 29 * i) * DEEIG_tmp[i] * DEEIG_tmp[i];
	}
	return f;
}